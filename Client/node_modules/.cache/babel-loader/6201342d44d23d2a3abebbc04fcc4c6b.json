{"ast":null,"code":"import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _toConsumableArray from\"H:/Mern Stack Projects/WebApp/Server/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"H:/Mern Stack Projects/WebApp/Server/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useRef,useEffect}from'react';import{useSelector,useDispatch}from'react-redux';import{GLOBALTYPES}from'../redux/actions/globalTypes';import{createPost,updatePost}from'../redux/actions/postAction';import Icons from'./Icons';import{imageShow,videoShow}from'../utils/mediaShow';var StatusModal=function StatusModal(){var _useSelector=useSelector(function(state){return state;}),auth=_useSelector.auth,theme=_useSelector.theme,status=_useSelector.status,socket=_useSelector.socket;var dispatch=useDispatch();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),content=_useState2[0],setContent=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),images=_useState4[0],setImages=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),stream=_useState6[0],setStream=_useState6[1];var videoRef=useRef();var refCanvas=useRef();var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),tracks=_useState8[0],setTracks=_useState8[1];var handleChangeImages=function handleChangeImages(e){var files=_toConsumableArray(e.target.files);var err=\"\";var newImages=[];files.forEach(function(file){if(!file)return err=\"File does not exist.\";if(file.size>1024*1024*5){return err=\"The image/video largest is 5mb.\";}return newImages.push(file);});if(err)dispatch({type:GLOBALTYPES.ALERT,payload:{error:err}});setImages([].concat(_toConsumableArray(images),newImages));};var deleteImages=function deleteImages(index){var newArr=_toConsumableArray(images);newArr.splice(index,1);setImages(newArr);};var handleStream=function handleStream(){setStream(true);if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){navigator.mediaDevices.getUserMedia({video:true}).then(function(mediaStream){videoRef.current.srcObject=mediaStream;videoRef.current.play();var track=mediaStream.getTracks();setTracks(track[0]);}).catch(function(err){return console.log(err);});}};var handleCapture=function handleCapture(){var width=videoRef.current.clientWidth;var height=videoRef.current.clientHeight;refCanvas.current.setAttribute(\"width\",width);refCanvas.current.setAttribute(\"height\",height);var ctx=refCanvas.current.getContext('2d');ctx.drawImage(videoRef.current,0,0,width,height);var URL=refCanvas.current.toDataURL();setImages([].concat(_toConsumableArray(images),[{camera:URL}]));};var handleStopStream=function handleStopStream(){tracks.stop();setStream(false);};var handleSubmit=function handleSubmit(e){e.preventDefault();if(images.length===0)return dispatch({type:GLOBALTYPES.ALERT,payload:{error:\"Please add your photo.\"}});if(status.onEdit){dispatch(updatePost({content:content,images:images,auth:auth,status:status}));}else{dispatch(createPost({content:content,images:images,auth:auth,socket:socket}));}setContent('');setImages([]);if(tracks)tracks.stop();dispatch({type:GLOBALTYPES.STATUS,payload:false});};useEffect(function(){if(status.onEdit){setContent(status.content);setImages(status.images);}},[status]);return/*#__PURE__*/_jsx(\"div\",{className:\"status_modal\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"status_header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"m-0\",children:\"Create Post\"}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return dispatch({type:GLOBALTYPES.STATUS,payload:false});},children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"status_body\",children:[/*#__PURE__*/_jsx(\"textarea\",{name:\"content\",value:content,placeholder:\"\".concat(auth.user.username,\", what are you thinking?\"),onChange:function onChange(e){return setContent(e.target.value);},style:{filter:theme?'invert(1)':'invert(0)',color:theme?'white':'#111',background:theme?'rgba(0,0,0,.03)':''}}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-fill\"}),/*#__PURE__*/_jsx(Icons,{setContent:setContent,content:content,theme:theme})]}),/*#__PURE__*/_jsx(\"div\",{className:\"show_images\",children:images.map(function(img,index){return/*#__PURE__*/_jsxs(\"div\",{id:\"file_img\",children:[img.camera?imageShow(img.camera,theme):img.url?/*#__PURE__*/_jsx(_Fragment,{children:img.url.match(/video/i)?videoShow(img.url,theme):imageShow(img.url,theme)}):/*#__PURE__*/_jsx(_Fragment,{children:img.type.match(/video/i)?videoShow(URL.createObjectURL(img),theme):imageShow(URL.createObjectURL(img),theme)}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return deleteImages(index);},children:\"\\xD7\"})]},index);})}),stream&&/*#__PURE__*/_jsxs(\"div\",{className:\"stream position-relative\",children:[/*#__PURE__*/_jsx(\"video\",{autoPlay:true,muted:true,ref:videoRef,width:\"100%\",height:\"100%\",style:{filter:theme?'invert(1)':'invert(0)'}}),/*#__PURE__*/_jsx(\"span\",{onClick:handleStopStream,children:\"\\xD7\"}),/*#__PURE__*/_jsx(\"canvas\",{ref:refCanvas,style:{display:'none'}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"input_images\",children:stream?/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-camera\",onClick:handleCapture}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-camera\",onClick:handleStream}),/*#__PURE__*/_jsxs(\"div\",{className:\"file_upload\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-image\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"file\",id:\"file\",multiple:true,accept:\"image/*,video/*\",onChange:handleChangeImages})]})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"status_footer\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary w-100\",type:\"submit\",children:\"Post\"})})]})});};export default StatusModal;","map":{"version":3,"sources":["H:/Mern Stack Projects/WebApp/server/client/src/components/StatusModal.js"],"names":["React","useState","useRef","useEffect","useSelector","useDispatch","GLOBALTYPES","createPost","updatePost","Icons","imageShow","videoShow","StatusModal","state","auth","theme","status","socket","dispatch","content","setContent","images","setImages","stream","setStream","videoRef","refCanvas","tracks","setTracks","handleChangeImages","e","files","target","err","newImages","forEach","file","size","push","type","ALERT","payload","error","deleteImages","index","newArr","splice","handleStream","navigator","mediaDevices","getUserMedia","video","then","mediaStream","current","srcObject","play","track","getTracks","catch","console","log","handleCapture","width","clientWidth","height","clientHeight","setAttribute","ctx","getContext","drawImage","URL","toDataURL","camera","handleStopStream","stop","handleSubmit","preventDefault","length","onEdit","STATUS","user","username","value","filter","color","background","map","img","url","match","createObjectURL","display"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from 'react'\nimport { useSelector, useDispatch } from 'react-redux'\nimport { GLOBALTYPES } from '../redux/actions/globalTypes'\nimport { createPost, updatePost } from '../redux/actions/postAction'\nimport Icons from './Icons'\nimport { imageShow, videoShow } from '../utils/mediaShow'\n\nconst StatusModal = () => {\n    const { auth, theme, status, socket } = useSelector(state => state)\n    const dispatch = useDispatch()\n\n    const [content, setContent] = useState('')\n    const [images, setImages] = useState([])\n\n    const [stream, setStream] = useState(false)\n    const videoRef = useRef()\n    const refCanvas = useRef()\n    const [tracks, setTracks] = useState('')\n\n    const handleChangeImages = e => {\n        const files = [...e.target.files]\n        let err = \"\"\n        let newImages = []\n\n        files.forEach(file => {\n            if(!file) return err = \"File does not exist.\"\n\n            if(file.size > 1024 * 1024 * 5){\n                return err = \"The image/video largest is 5mb.\"\n            }\n\n            return newImages.push(file)\n        })\n\n        if(err) dispatch({ type: GLOBALTYPES.ALERT, payload: {error: err} })\n        setImages([...images, ...newImages])\n    }\n\n    const deleteImages = (index) => {\n        const newArr = [...images]\n        newArr.splice(index, 1)\n        setImages(newArr)\n    }\n\n    const handleStream = () => {\n        setStream(true)\n        if(navigator.mediaDevices && navigator.mediaDevices.getUserMedia){\n            navigator.mediaDevices.getUserMedia({video: true})\n            .then(mediaStream => {\n                videoRef.current.srcObject = mediaStream\n                videoRef.current.play()\n\n                const track = mediaStream.getTracks()\n                setTracks(track[0])\n            }).catch(err => console.log(err))\n        }\n    }\n\n    const handleCapture = () => {\n        const width = videoRef.current.clientWidth;\n        const height = videoRef.current.clientHeight;\n\n        refCanvas.current.setAttribute(\"width\", width)\n        refCanvas.current.setAttribute(\"height\", height)\n\n        const ctx = refCanvas.current.getContext('2d')\n        ctx.drawImage(videoRef.current, 0, 0, width, height)\n        let URL = refCanvas.current.toDataURL()\n        setImages([...images, {camera: URL}])\n    }\n\n    const handleStopStream = () => {\n        tracks.stop()\n        setStream(false)\n    }\n\n    const handleSubmit = (e) => {\n        e.preventDefault()\n        if(images.length === 0)\n        return dispatch({ \n            type: GLOBALTYPES.ALERT, payload: {error: \"Please add your photo.\"}\n        })\n\n        if(status.onEdit){\n            dispatch(updatePost({content, images, auth, status}))\n        }else{\n            dispatch(createPost({content, images, auth, socket}))\n        }\n        \n\n        setContent('')\n        setImages([])\n        if(tracks) tracks.stop()\n        dispatch({ type: GLOBALTYPES.STATUS, payload: false})\n    }\n\n    useEffect(() => {\n        if(status.onEdit){\n            setContent(status.content)\n            setImages(status.images)\n        }\n    },[status])\n\n\n   \n\n    return (\n        <div className=\"status_modal\">\n            <form onSubmit={handleSubmit}>\n                <div className=\"status_header\">\n                    <h5 className=\"m-0\">Create Post</h5>\n                    <span onClick={() => dispatch({\n                        type: GLOBALTYPES.STATUS, payload: false\n                    })}>\n                        &times;\n                    </span>\n                </div>\n\n                <div className=\"status_body\">\n                    <textarea name=\"content\" value={content}\n                    placeholder={`${auth.user.username}, what are you thinking?`}\n                    onChange={e => setContent(e.target.value)}\n                    style={{\n                        filter: theme ? 'invert(1)' : 'invert(0)',\n                        color: theme ? 'white' : '#111',\n                        background: theme ? 'rgba(0,0,0,.03)' : '',\n                    }} />\n\n                    <div className=\"d-flex\">\n                        <div className=\"flex-fill\"></div>\n                        <Icons setContent={setContent} content={content} theme={theme} />\n                    </div>\n\n                    <div className=\"show_images\">\n                        {\n                            images.map((img, index) => (\n                                <div key={index} id=\"file_img\">\n                                    {\n                                        img.camera ? imageShow(img.camera, theme)\n                                        : img.url\n                                            ?<>\n                                                {\n                                                    img.url.match(/video/i)\n                                                    ? videoShow(img.url, theme) \n                                                    : imageShow(img.url, theme)\n                                                }\n                                            </>\n                                            :<>\n                                                {\n                                                    img.type.match(/video/i)\n                                                    ? videoShow(URL.createObjectURL(img), theme) \n                                                    : imageShow(URL.createObjectURL(img), theme)\n                                                }\n                                            </>\n                                    }\n                                    <span onClick={() => deleteImages(index)}>&times;</span>\n                                </div>\n                            ))\n                        }\n                    </div>\n\n                    {\n                        stream && \n                        <div className=\"stream position-relative\">\n                            <video autoPlay muted ref={videoRef} width=\"100%\" height=\"100%\"\n                            style={{filter: theme ? 'invert(1)' : 'invert(0)'}} />\n                            \n                            <span onClick={handleStopStream}>&times;</span>\n                            <canvas ref={refCanvas} style={{display: 'none'}} />\n                        </div>\n                    }\n\n                    <div className=\"input_images\">\n                        {\n                            stream \n                            ? <i className=\"fas fa-camera\" onClick={handleCapture} />\n                            : <>\n                                <i className=\"fas fa-camera\" onClick={handleStream} />\n\n                                <div className=\"file_upload\">\n                                    <i className=\"fas fa-image\" />\n                                    <input type=\"file\" name=\"file\" id=\"file\"\n                                    multiple accept=\"image/*,video/*\" onChange={handleChangeImages} />\n                                </div>\n                            </>\n                        }\n                        \n                    </div>\n\n                </div>\n\n                <div className=\"status_footer\">\n                    <button className=\"btn btn-secondary w-100\" type=\"submit\">\n                        Post\n                    </button>\n                </div>\n\n            </form>\n        </div>\n    )\n}\n\nexport default StatusModal\n"]},"metadata":{},"sourceType":"module"}