{"ast":null,"code":"import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _objectSpread from\"H:/Mern Stack Projects/WebApp/Server/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"H:/Mern Stack Projects/WebApp/Server/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"H:/Mern Stack Projects/WebApp/Server/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"H:/Mern Stack Projects/WebApp/Server/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import Avatar from'../../Avatar';import{Link}from'react-router-dom';import moment from'moment';import LikeButton from'../../LikeButton';import{useSelector,useDispatch}from'react-redux';import CommentMenu from'./CommentMenu';import{updateComment,likeComment,unLikeComment}from'../../../redux/actions/commentAction';import InputComment from'../InputComment';var CommentCard=function CommentCard(_ref){var children=_ref.children,comment=_ref.comment,post=_ref.post,commentId=_ref.commentId;var _useSelector=useSelector(function(state){return state;}),auth=_useSelector.auth,theme=_useSelector.theme;var dispatch=useDispatch();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),content=_useState2[0],setContent=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),readMore=_useState4[0],setReadMore=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),onEdit=_useState6[0],setOnEdit=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isLike=_useState8[0],setIsLike=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),loadLike=_useState10[0],setLoadLike=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),onReply=_useState12[0],setOnReply=_useState12[1];useEffect(function(){setContent(comment.content);setIsLike(false);setOnReply(false);if(comment.likes.find(function(like){return like._id===auth.user._id;})){setIsLike(true);}},[comment,auth.user._id]);var handleUpdate=function handleUpdate(){if(comment.content!==content){dispatch(updateComment({comment:comment,post:post,content:content,auth:auth}));setOnEdit(false);}else{setOnEdit(false);}};var handleLike=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!loadLike){_context.next=2;break;}return _context.abrupt(\"return\");case 2:setIsLike(true);setLoadLike(true);_context.next=6;return dispatch(likeComment({comment:comment,post:post,auth:auth}));case 6:setLoadLike(false);case 7:case\"end\":return _context.stop();}}},_callee);}));return function handleLike(){return _ref2.apply(this,arguments);};}();var handleUnLike=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!loadLike){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:setIsLike(false);setLoadLike(true);_context2.next=6;return dispatch(unLikeComment({comment:comment,post:post,auth:auth}));case 6:setLoadLike(false);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function handleUnLike(){return _ref3.apply(this,arguments);};}();var handleReply=function handleReply(){if(onReply)return setOnReply(false);setOnReply(_objectSpread(_objectSpread({},comment),{},{commentId:commentId}));};var styleCard={opacity:comment._id?1:0.5,pointerEvents:comment._id?'inherit':'none'};return/*#__PURE__*/_jsxs(\"div\",{className:\"comment_card mt-2\",style:styleCard,children:[/*#__PURE__*/_jsxs(Link,{to:\"/profile/\".concat(comment.user._id),className:\"d-flex text-dark\",children:[/*#__PURE__*/_jsx(Avatar,{src:comment.user.avatar,size:\"small-avatar\"}),/*#__PURE__*/_jsx(\"h6\",{className:\"mx-1\",children:comment.user.username})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"comment_content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-fill\",style:{filter:theme?'invert(1)':'invert(0)',color:theme?'white':'#111'},children:[onEdit?/*#__PURE__*/_jsx(\"textarea\",{rows:\"5\",value:content,onChange:function onChange(e){return setContent(e.target.value);}}):/*#__PURE__*/_jsxs(\"div\",{children:[comment.tag&&comment.tag._id!==comment.user._id&&/*#__PURE__*/_jsxs(Link,{to:\"/profile/\".concat(comment.tag._id),className:\"mr-1\",children:[\"@\",comment.tag.username]}),/*#__PURE__*/_jsx(\"span\",{children:content.length<100?content:readMore?content+' ':content.slice(0,100)+'....'}),content.length>100&&/*#__PURE__*/_jsx(\"span\",{className:\"readMore\",onClick:function onClick(){return setReadMore(!readMore);},children:readMore?'Hide content':'Read more'})]}),/*#__PURE__*/_jsxs(\"div\",{style:{cursor:'pointer'},children:[/*#__PURE__*/_jsx(\"small\",{className:\"text-muted mr-3\",children:moment(comment.createdAt).fromNow()}),/*#__PURE__*/_jsxs(\"small\",{className:\"font-weight-bold mr-3\",children:[comment.likes.length,\" likes\"]}),onEdit?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"small\",{className:\"font-weight-bold mr-3\",onClick:handleUpdate,children:\"update\"}),/*#__PURE__*/_jsx(\"small\",{className:\"font-weight-bold mr-3\",onClick:function onClick(){return setOnEdit(false);},children:\"cancel\"})]}):/*#__PURE__*/_jsx(\"small\",{className:\"font-weight-bold mr-3\",onClick:handleReply,children:onReply?'cancel':'reply'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center mx-2\",style:{cursor:'pointer'},children:[/*#__PURE__*/_jsx(CommentMenu,{post:post,comment:comment,setOnEdit:setOnEdit}),/*#__PURE__*/_jsx(LikeButton,{isLike:isLike,handleLike:handleLike,handleUnLike:handleUnLike})]})]}),onReply&&/*#__PURE__*/_jsx(InputComment,{post:post,onReply:onReply,setOnReply:setOnReply,children:/*#__PURE__*/_jsxs(Link,{to:\"/profile/\".concat(onReply.user._id),className:\"mr-1\",children:[\"@\",onReply.user.username,\":\"]})}),children]});};export default CommentCard;","map":{"version":3,"sources":["H:/Mern Stack Projects/WebApp/server/client/src/components/home/comments/CommentCard.js"],"names":["React","useState","useEffect","Avatar","Link","moment","LikeButton","useSelector","useDispatch","CommentMenu","updateComment","likeComment","unLikeComment","InputComment","CommentCard","children","comment","post","commentId","state","auth","theme","dispatch","content","setContent","readMore","setReadMore","onEdit","setOnEdit","isLike","setIsLike","loadLike","setLoadLike","onReply","setOnReply","likes","find","like","_id","user","handleUpdate","handleLike","handleUnLike","handleReply","styleCard","opacity","pointerEvents","avatar","username","filter","color","e","target","value","tag","length","slice","cursor","createdAt","fromNow"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport Avatar from '../../Avatar'\nimport { Link } from 'react-router-dom'\nimport moment from 'moment'\n\nimport LikeButton from '../../LikeButton'\nimport { useSelector, useDispatch } from 'react-redux'\nimport CommentMenu from './CommentMenu'\nimport { updateComment, likeComment, unLikeComment } from '../../../redux/actions/commentAction'\nimport InputComment from '../InputComment'\n\nconst CommentCard = ({children, comment, post, commentId}) => {\n    const { auth, theme } = useSelector(state => state)\n    const dispatch = useDispatch()\n\n    const [content, setContent] = useState('')\n    const [readMore, setReadMore] = useState(false)\n\n    const [onEdit, setOnEdit] = useState(false)\n    const [isLike, setIsLike] = useState(false)\n    const [loadLike, setLoadLike] = useState(false)\n\n    const [onReply, setOnReply] = useState(false)\n\n\n    useEffect(() => {\n        setContent(comment.content)\n        setIsLike(false)\n        setOnReply(false)\n        if(comment.likes.find(like => like._id === auth.user._id)){\n            setIsLike(true)\n        }\n    },[comment, auth.user._id])\n\n    const handleUpdate = () => {\n        if(comment.content !== content){\n            dispatch(updateComment({comment, post, content, auth}))\n            setOnEdit(false)\n        }else{\n            setOnEdit(false)\n        }\n    }\n\n\n    const handleLike = async () => {\n        if(loadLike) return;\n        setIsLike(true)\n\n        setLoadLike(true)\n        await dispatch(likeComment({comment, post, auth}))\n        setLoadLike(false)\n    }\n\n    const handleUnLike = async () => {\n        if(loadLike) return;\n        setIsLike(false)\n\n        setLoadLike(true)\n        await dispatch(unLikeComment({comment, post, auth}))\n        setLoadLike(false)\n    }\n\n\n    const handleReply = () => {\n        if(onReply) return setOnReply(false)\n        setOnReply({...comment, commentId})\n    }\n\n    const styleCard = {\n        opacity: comment._id ? 1 : 0.5,\n        pointerEvents: comment._id ? 'inherit' : 'none'\n    }\n\n    return (\n        <div className=\"comment_card mt-2\" style={styleCard}>\n            <Link to={`/profile/${comment.user._id}`} className=\"d-flex text-dark\">\n                <Avatar src={comment.user.avatar} size=\"small-avatar\" />\n                <h6 className=\"mx-1\">{comment.user.username}</h6>\n            </Link>\n\n            <div className=\"comment_content\">\n                <div className=\"flex-fill\" \n                style={{\n                    filter: theme ? 'invert(1)' : 'invert(0)',\n                    color: theme ? 'white' : '#111',\n                }}>\n                    {\n                        onEdit \n                        ? <textarea rows=\"5\" value={content}\n                        onChange={e => setContent(e.target.value)} />\n\n                        : <div>\n                            {\n                                comment.tag && comment.tag._id !== comment.user._id &&\n                                <Link to={`/profile/${comment.tag._id}`} className=\"mr-1\">\n                                    @{comment.tag.username}\n                                </Link>\n                            }\n                            <span>\n                                {\n                                    content.length < 100 ? content :\n                                    readMore ? content + ' ' : content.slice(0, 100) + '....'\n                                }\n                            </span>\n                            {\n                                content.length > 100 &&\n                                <span className=\"readMore\" onClick={() => setReadMore(!readMore)}>\n                                    {readMore ? 'Hide content' : 'Read more'}\n                                </span>\n                            }\n                        </div>\n                    }\n                    \n\n                    <div style={{cursor: 'pointer'}}>\n                        <small className=\"text-muted mr-3\">\n                            {moment(comment.createdAt).fromNow()}\n                        </small>\n\n                        <small className=\"font-weight-bold mr-3\">\n                            {comment.likes.length} likes\n                        </small>\n\n                        {\n                            onEdit\n                            ? <>\n                                <small className=\"font-weight-bold mr-3\"\n                                onClick={handleUpdate}>\n                                    update\n                                </small>\n                                <small className=\"font-weight-bold mr-3\"\n                                onClick={() => setOnEdit(false)}>\n                                    cancel\n                                </small>\n                            </>\n\n                            : <small className=\"font-weight-bold mr-3\"\n                            onClick={handleReply}>\n                                {onReply ? 'cancel' :'reply'}\n                            </small>\n                        }\n                        \n                    </div>\n                    \n                </div>\n\n\n                <div className=\"d-flex align-items-center mx-2\" style={{cursor: 'pointer'}}>\n                    <CommentMenu post={post} comment={comment} setOnEdit={setOnEdit} />\n                    <LikeButton isLike={isLike} handleLike={handleLike} handleUnLike={handleUnLike} />\n                </div>\n            </div> \n            \n            {\n                onReply &&\n                <InputComment post={post} onReply={onReply} setOnReply={setOnReply} >\n                    <Link to={`/profile/${onReply.user._id}`} className=\"mr-1\">\n                        @{onReply.user.username}:\n                    </Link>\n                </InputComment>\n            }\n\n            {children}\n        </div>\n    )\n}\n\nexport default CommentCard\n"]},"metadata":{},"sourceType":"module"}